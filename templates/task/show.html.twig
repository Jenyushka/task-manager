{% extends 'base.html.twig' %}

{% block title %}{{ task.title }}{% endblock %}

{% block body %}
<div class="card">
    <h2>{{ task.title }}</h2>
    
    <div style="margin: 20px 0; padding: 15px; background-color: #f8f9fa; border-radius: 5px;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <div>
                <strong>Type:</strong><br>
                <span style="background-color: #e8f4f8; padding: 4px 8px; border-radius: 3px; font-size: 14px;">
                    {{ task.typeName }}
                </span>
            </div>
            <div>
                <strong>Status:</strong><br>
                {% if task.completed %}
                    <span style="color: #27ae60; font-weight: bold;">✓ Completed</span>
                {% else %}
                    <span style="color: #f39c12; font-weight: bold;">○ Open</span>
                {% endif %}
            </div>
            <div>
                <strong>Created:</strong><br>
                {{ task.createdAt|date('Y-m-d H:i:s') }}
            </div>
            {% if task.priority is defined %}
                <div>
                    <strong>Priority:</strong><br>
                    <span style="padding: 4px 8px; border-radius: 3px; font-size: 14px;
                        {% if task.priority == 'critical' %}
                            background-color: #e74c3c; color: white;
                        {% elseif task.priority == 'high' %}
                            background-color: #e67e22; color: white;
                        {% elseif task.priority == 'medium' %}
                            background-color: #f39c12; color: white;
                        {% else %}
                            background-color: #95a5a6; color: white;
                        {% endif %}
                    ">
                        {{ task.priorityLabel }}
                    </span>
                </div>
            {% endif %}
        </div>
    </div>
    
    <div style="margin: 20px 0;">
        <h3>Description</h3>
        <p style="white-space: pre-wrap;">{{ task.description }}</p>
    </div>
    
    {% if task.notes is defined %}
        <div style="margin: 20px 0; padding: 15px; background-color: #fffbea; border-left: 4px solid #f39c12; border-radius: 3px;">
            <h3>Notes</h3>
            <p style="white-space: pre-wrap;">{{ task.notes }}</p>
        </div>
    {% endif %}
    
    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #dee2e6;">
        {% if not task.completed %}
            <form method="post" action="{{ path('task_complete', {'id': task.id}) }}" style="display: inline;">
                <input type="hidden" name="_token" value="{{ csrf_token('complete' ~ task.id) }}">
                <button type="submit" class="btn btn-success">✓ Mark as Completed</button>
            </form>
        {% else %}
            <form method="post" action="{{ path('task_reopen', {'id': task.id}) }}" style="display: inline;">
                <input type="hidden" name="_token" value="{{ csrf_token('reopen' ~ task.id) }}">
                <button type="submit" class="btn btn-secondary">↺ Reopen Task</button>
            </form>
        {% endif %}
        
        <a href="{{ path('task_index') }}" class="btn btn-primary">← Back to List</a>
        
        <form method="post" action="{{ path('task_delete', {'id': task.id}) }}" style="display: inline; float: right;" onsubmit="return confirm('Are you sure you want to delete this task?');">
            <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ task.id) }}">
            <button type="submit" class="btn btn-danger">Delete</button>
        </form>
    </div>
</div>
{% endblock %}
